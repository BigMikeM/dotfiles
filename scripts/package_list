#!/bin/bash
# Package definitions for different distributions and package managers
# Cross-platform consistency strategy for unified experience across all distros
#
# Package Priority Strategy (for maximum cross-platform consistency):
# 1. System packages (rpm, apt, pacman) - ONLY for:
#    - Core system tools (gcc, make, git, zsh)
#    - System libraries and development headers
#    - Shell utilities (shellcheck, shfmt)
#    - Terminal emulators (ghostty - native Wayland)
#
# 2. Cargo packages (Rust) - PRIMARY choice for CLI tools:
#    - Modern CLI replacements (fd, rg, bat, lsd, dust, etc.)
#    - Development tools (gitui, cargo-*, just, etc.)
#    - Cross-platform with consistent versions
#    - Fast and reliable
#
# 3. Flatpak packages - ALL GUI applications:
#    - Web browsers (Firefox, Chrome)
#    - Media apps (GIMP, VLC, Audacity)
#    - Communication (Discord, Slack)
#    - Ensures same versions across all distros
#    - Sandboxed and secure
#
# 4. Language-specific package managers:
#    - fnm → Node.js and npm packages
#    - uv → Python CLI tools (ruff, pytest, jupyter, etc.)
#
# 5. Snap packages - AVOID (prefer Flatpak for GUI apps)
#
# This strategy ensures:
# - Identical user experience across Fedora, Ubuntu/Debian, Arch, and WSL
# - Latest versions of tools without distro-specific packaging delays
# - Minimal system package dependencies
# - Easy updates and maintenance

# Fedora/RHEL/CentOS packages (DNF/YUM)
# Note: Keep minimal - prefer Cargo/uv/Flatpak for cross-platform consistency
rpm_packages=(
	# Core development tools (system package manager is best for these)
	zsh
	git
	cmake
	openssh
	gcc
	gcc-c++
	make

	# Basic system utilities
	tree
	gh
	trash-cli
	bc
	curl
	wget
	unzip
	zip
	jq
	fastfetch

	# Shell utilities
	shellcheck
	shfmt

	# Python (system)
	python3
	python3-devel

	# Lua (for Neovim)
	luarocks

	# Terminal emulator (native Wayland support)
	ghostty

	# Libraries and dependencies
	pkg-config
	openssl-devel
	fontconfig-devel
	freetype-devel
	mesa-libGL-devel
	alsa-lib-devel

	# Note: GUI apps (Firefox, GIMP, VLC) now via Flatpak for consistency
	# Note: Modern CLI tools (bat, fd, rg, etc.) via Cargo
	# Note: Neovim installed via AppImage for latest version
	# Note: ranger, atool, highlight via Cargo/pip where better
)

# RPM Fusion repositories (if available)
if command -v rpm >/dev/null 2>&1; then
	rpm_nonfree=(
		"https://mirrors.rpmfusion.org/free/fedora/rpmfusion-free-release-$(rpm -E %fedora).noarch.rpm"
		"https://mirrors.rpmfusion.org/nonfree/fedora/rpmfusion-nonfree-release-$(rpm -E %fedora).noarch.rpm"
	)
fi

rpm_groups=(
	"@c-development"
	"@development-tools"
	"@development-libs"
)

# WSL-specific packages (Debian/Ubuntu-based)
# Note: Keep minimal - prefer Cargo/uv for cross-platform consistency
wsl_packages=(
	# Core development tools
	build-essential
	zsh
	git
	cmake
	openssh-client
	gcc
	g++
	make

	# Basic system utilities
	tree
	gh
	trash-cli
	bc
	curl
	wget
	unzip
	zip
	jq
	fastfetch

	# Shell utilities
	shellcheck
	shfmt

	# Python (system)
	python3
	python-is-python3
	python3-dev

	# Lua (for Neovim)
	luarocks
	luacheck

	# Libraries and dependencies
	pkg-config
	libssl-dev
	ca-certificates
	gnupg

	# Note: Modern CLI tools (bat, fd, rg, etc.) via Cargo
	# Note: Neovim installed via AppImage for latest version
	# Note: No GUI apps in WSL (use Windows apps or WSLg with Flatpak)
)

# Raspberry Pi packages (Debian-based - Raspberry Pi OS)
# Note: Ultra-lightweight - RPi has limited resources (CPU, RAM)
# Skip: Heavy GUI apps, resource-intensive tools, unnecessary libraries
rpi_packages=(
	# Core development tools (minimal set)
	zsh
	git
	cmake
	gcc
	g++
	make
	build-essential

	# Essential system utilities only
	tree
	curl
	wget
	unzip
	zip
	bc
	jq

	# Shell utilities (lightweight)
	shellcheck
	# Note: Skip shfmt - can be slow on RPi

	# Python (system) - needed for many tools
	python3
	python-is-python3
	python3-dev

	# Lua (for Neovim)
	luarocks
	luacheck

	# Minimal libraries only
	pkg-config
	libssl-dev
	ca-certificates
	gnupg

	# Note: Skip terminal emulators - use default terminal or lightweight alternatives
	# Note: Skip ghostty - too resource intensive for RPi
	# Note: Skip development libraries - install only when needed
	# Note: Skip brightnessctl, playerctl - typically not needed on headless RPi
	# Note: All GUI apps via Flatpak (if running desktop) or skip entirely
	# Note: Modern CLI tools (bat, fd, rg) via Cargo but limited subset
	# Note: Neovim can be installed but avoid heavy plugins
)

# Ubuntu/Debian packages (APT)
# Note: Keep minimal - prefer Cargo/uv/Flatpak for cross-platform consistency
apt_packages=(
	# Core development tools
	build-essential
	zsh
	git
	cmake
	openssh-client
	gcc
	g++
	make

	# Basic system utilities
	tree
	gh
	trash-cli
	bc
	curl
	wget
	unzip
	zip
	jq
	fastfetch

	# Desktop utilities
	brightnessctl
	playerctl
	pulseaudio-utils

	# Shell utilities
	shellcheck
	shfmt

	# Python (system)
	python3
	python-is-python3
	python3-dev

	# Lua (for Neovim)
	luarocks
	luacheck

	# Terminal emulator (native Wayland support)
	ghostty

	# Libraries and dependencies
	pkg-config
	libssl-dev
	ca-certificates
	gnupg
	gcc-multilib
	g++-multilib
	libfreetype6-dev
	libasound2-dev
	libexpat1-dev
	libbz2-dev
	libsndio-dev
	freeglut3-dev
	libfontconfig1-dev
	mesa-common-dev
	libgl1-mesa-dev

	# Note: GUI apps (Firefox, GIMP, VLC) now via Flatpak for consistency
	# Note: Modern CLI tools (bat, fd, rg, etc.) via Cargo
	# Note: Neovim installed via AppImage for latest version
)

# Arch Linux packages (Pacman)
# Note: Keep minimal - prefer Cargo/uv/Flatpak for cross-platform consistency
arch_packages=(
	# AUR helper (Arch-specific)
	paru

	# Core development tools
	base-devel
	zsh
	git
	openssh
	gcc
	make
	cmake

	# Basic system utilities
	tree
	github-cli
	trash-cli
	bc
	curl
	wget
	unzip
	zip
	jq
	fastfetch

	# Desktop utilities
	brightnessctl
	playerctl

	# Shell utilities
	shellcheck
	shfmt

	# Python (system)
	python

	# Lua (for Neovim)
	luarocks
	luacheck

	# Terminal emulator (native Wayland support)
	ghostty

	# Libraries
	pkg-config
	openssl
	fontconfig
	freetype2
	libglvnd
	sndio
	gtk3
	sdl2

	# Note: GUI apps (Firefox, GIMP, VLC) now via Flatpak for consistency
	# Note: Modern CLI tools (bat, fd, rg, etc.) via Cargo
	# Note: Neovim installed via AppImage for latest version
	# Note: ghostty is the primary terminal emulator (Wayland-native, GPU-accelerated)
)

# Rust packages (Cargo) - Cross-platform CLI tools
# These provide consistent versions across all distributions
cargo_packages=(
	# Modern CLI replacements (cross-platform, better than system versions)
	fd-find    # Better find
	ripgrep    # Better grep (rg)
	bat        # Better cat with syntax highlighting
	lsd        # Better ls (LSDeluxe)
	du-dust    # Better du
	sd         # Better sed
	procs      # Better ps
	exa        # Another better ls (eza fork)

	# Shell management
	sheldon    # Zsh plugin manager (Rust-based, fast)
	starship   # Cross-shell prompt (fast, customizable)
	zoxide     # Smarter cd (z)
	atuin      # Shell history sync and search

	# File utilities
	broot      # File tree browser
	ranger-rs  # Rust implementation of ranger file manager

	# Development tools
	gitui         # Git TUI with vim keybindings
	cargo-update  # Update cargo packages
	cargo-watch   # Watch for file changes
	cargo-edit    # Add/remove cargo dependencies
	cargo-expand  # Expand macros
	cargo-outdated # Check for outdated dependencies

	# Build and development utilities
	just       # Command runner (like make but better)
	sccache    # Compiler cache for faster builds

	# Utilities
	tealdeer   # tldr client (faster than nodejs version)
	tokei      # Count lines of code
	hyperfine  # Benchmarking tool
	bandwhich  # Network utilization by process
	bottom     # System monitor (btm) - better than htop
	shellharden # Shell script linter
	ron-lsp    # RON (Rusty Object Notation) LSP and CLI

	# Text processing
	grex       # Generate regex from examples
	choose     # Better cut/awk

	# System monitoring
	zenith     # Process viewer (like top/htop)
)

# Raspberry Pi Cargo packages - Lightweight subset only
# Skip resource-intensive tools that would be slow on RPi
rpi_cargo_packages=(
	# Essential CLI replacements (lightweight and useful)
	fd-find    # Better find
	ripgrep    # Better grep (rg)
	bat        # Better cat with syntax highlighting
	lsd        # Better ls (LSDeluxe)

	# Shell management (essential)
	sheldon    # Zsh plugin manager (Rust-based, fast)
	starship   # Cross-shell prompt (lightweight)
	zoxide     # Smarter cd (z)

	# Basic development tools only
	gitui         # Git TUI (useful even on RPi)
	cargo-update  # Update cargo packages

	# Lightweight utilities
	tealdeer   # tldr client (fast and small)

	# Note: Skip heavy tools to preserve RPi performance:
	# - du-dust, procs, exa (redundant, use standard tools)
	# - atuin (history sync - resource intensive)
	# - broot, ranger-rs (file browsers - slow on RPi)
	# - cargo-watch, cargo-edit, cargo-expand, cargo-outdated (development - compile intensive)
	# - just, sccache (build tools - RPi rarely used for compilation)
	# - tokei, hyperfine, bandwhich, bottom, zenith (monitoring - resource intensive)
	# - shellharden, ron-lsp, grex, choose (niche tools, can install manually if needed)
)

# Python CLI tools (via uv tool install)
# Note: uv is installed via its own installer script (https://astral.sh/uv/install.sh)
# uv tool install is ONLY for packages that provide CLI executables
uv_tools=(
	# Development tools
	ruff       # Fast Python linter and formatter (provides: ruff)
	pytest     # Testing framework (provides: pytest, py.test)
	pylint     # Code analysis tool (provides: pylint, pyreverse, etc.)

	# Jupyter ecosystem - CLI tools only
	jupyterlab # JupyterLab interface (provides: jupyter-lab, jupyter-labextension)
	ipython    # Enhanced Python shell (provides: ipython, ipython3)

	# Utilities with executables
	jsonschema # JSON schema validation (provides: jsonschema)
	typer      # CLI application framework (provides: typer)
)

# Python libraries (installed system-wide or in projects via uv pip/venv)
# These are libraries without CLI executables - don't use uv tool install for these
# Instead, install them in project virtual environments with: uv venv && uv pip install <package>
# Or create a global virtual environment if needed
uv_libraries_reference=(
	# Note: These should NOT be installed globally with uv tool install
	# They're listed here for reference only
	#
	# Data science:
	#   pandas, numpy, matplotlib, scipy, scikit-learn
	#
	# Utilities:
	#   requests, pyyaml, rich (as library), jinja2
	#
	# Install in projects with:
	#   cd your-project && uv venv && uv pip install pandas numpy matplotlib
)

# Node.js packages (npm) - Installed via fnm-managed Node.js
npm_packages=(
	# Package management
	npm-check-updates
	pnpm
	yarn

	# Development tools
	typescript
	ts-node
	eslint
	prettier

	# Build tools
	webpack
	webpack-cli
	vite

	# Utilities
	http-server
	json-server
	live-server

	# Documentation
	markdown-cli

	# Testing
	jest
	mocha

	# Linting and formatting
	standard
	jshint

	# Development servers
	nodemon
	concurrently

	# Package auditing
	npm-audit-resolver

	# Global CLI tools
	create-react-app
	create-next-app
	create-vue

	# Additional useful tools
	forever
	pm2
	serve
)

# Additional package arrays for other package managers
# Snap packages - only for packages that work better as snaps
snap_packages=(
	code # VS Code - better as snap for auto-updates and extensions
)

# Flatpak packages - GUI applications for cross-platform consistency
# Using Flatpak ensures same versions across all distros with sandboxing
flatpak_packages=(
	# System utilities
	com.github.tchx84.Flatseal # Flatpak permission manager

	# Media applications
	org.gimp.GIMP              # GIMP - image editor
	org.videolan.VLC           # VLC - media player
	org.audacityteam.Audacity  # Audacity - audio editor

	# Communication
	com.discordapp.Discord     # Discord - official flatpak

	# Music streaming
	com.spotify.Client         # Spotify - only available as flatpak

	# Development tools (GUI)
	com.vscodium.codium        # VSCodium (alternative to VS Code snap)

	# Note: All GUI apps moved to Flatpak for:
	# - Consistent versions across distros
	# - Sandboxing and security
	# - Automatic updates
	# - No dependency conflicts
)

# Raspberry Pi Flatpak packages - Minimal GUI apps if running desktop
# Most RPi setups are headless, but for desktop setups use minimal apps only
rpi_flatpak_packages=(
	# Essential browser (if running desktop)
	org.mozilla.firefox        # Firefox - lightweight enough for RPi 4+

	# Note: Skip heavy apps on RPi:
	# - GIMP, Audacity (resource intensive)
	# - VLC (use mpv or omxplayer instead)
	# - Discord, Slack, Spotify (too heavy for RPi)
	# - VSCodium (use vim/neovim instead)
	# - Chrome (too heavy, use Firefox)
)

# Export all package arrays
export rpm_packages rpm_groups rpm_nonfree arch_packages cargo_packages
export uv_tools uv_libraries_reference apt_packages npm_packages wsl_packages snap_packages flatpak_packages
export rpi_packages rpi_cargo_packages rpi_flatpak_packages
